{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ product.name }} - Cozy Home</title>
    <link rel="stylesheet" href="{% static 'furniture/css/detailed.css' %}">
</head>
<body>
    <header>
        <h1>Cozy Home</h1>
        <nav> 
            <a href="{% url 'home' %}">Home</a>
            <a href="#about">About</a>
            <a href="#contact">Contact</a>
        </nav>
        <a href="{% url 'view_cart' %}" id="cart-count">Cart: {{ cart_item_count }}</a>
    </header>

    {% if messages %}
        {% for message in messages %}
            <div class="message {{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}


    <section class="product-detail">
        <h2>{{ product.name }}</h2>
        <p>Price: ${{ product.price }}</p>

        <div class="gallery-container">
            <!-- Left: Thumbnails -->
            <div class="product-images">
                <img class="thumbnail" src="{{ product.main_image.url }}" alt="{{ product.name }}">
                {% for img in product.images.all %}
                    <img class="thumbnail" src="{{ img.image.url }}" alt="{{ product.name }}">
                {% endfor %}
            </div>

            <!-- Right: Large preview -->
            <div class="preview-image">
                <img id="mainPreview" src="{{ product.main_image.url }}" alt="{{ product.name }}">
            </div>
        </div>

        <p>{{ product.description }}</p>

        <!-- Add to Cart Form -->
        <form method="post" action="{% url 'add_to_cart' product.id %}">
            {% csrf_token %}
    
            {% if product.stock == 0 %}
                <h2 style="color: red;">OUT OF STOCK</h2>
                <button disabled>Out of Stock</button>
            {% else %}
                <h2>In stock: {{ product.stock }}</h2>
                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" name="quantity" value="1" min="1" max="{{ product.stock }}">
                <button type="submit" class="add-to-cart">Add to Cart</button>
            {% endif %}
        </form>

    </section>
</body>
</html>

<script>
    const thumbnails = document.querySelectorAll('.thumbnail');
    const mainPreview = document.getElementById('mainPreview');

    thumbnails.forEach(thumbnail => {
        thumbnail.addEventListener('click', () => {
            mainPreview.src = thumbnail.src;
        });
    });
</script>

{% comment %} {% if product.stock == 0 %}
    <h2 class="out-of-stock">OUT OF STOCK</h2>
{% else %}
    <h2>In stock: {{ product.stock }}</h2>
{% endif %} {% endcomment %}